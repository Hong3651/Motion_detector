# Motion_detector (OpenCV C++)

무인 공공시설(스터디카페/스마트 라이브러리) 환경에서 좌석 점유(16개 ROI)와 금지구역 침입(Restricted ROI)을 영상 기반으로 감지하고,  
결과를 로그(JSONL/TXT) 형태로 남겨 추후 데이터 분석(EDA) 및 혼잡도/인기좌석 예측 모델로 확장하는 프로젝트.

---

## 1. 프로젝트 목표 (Why)
### 1) 1차 목표: 야간 침입/이상 상황 로그화
- 금지구역(출입 제한 ROI)에서 움직임이 감지되면 **침입 이벤트**로 기록
- 시간대별 침입 발생 빈도, 지속시간 등을 추후 분석 가능한 형태로 저장

### 2) 2차 목표: 좌석 점유 데이터 축적 → 혼잡도/인기좌석 분석
- 좌석 ROI별 움직임/점유 상태를 시간 단위로 기록하여
  - 인기 좌석(점유율 상위)
  - 혼잡 시간대(peak time)
  - 평균 점유 시간, 회전률 등 파생변수 도출
- 향후 예측 모델(혼잡도/좌석 점유 확률)을 만들 수 있는 데이터셋 구축

---

## 2. 핵심 기능 (What)
- **영상 입력**: 웹캠(실시간) 또는 mp4 파일
- **ROI 설정**: 좌석 16개 + 금지구역 N개를 ROI로 지정
- **움직임 감지**: 프레임 차분 기반 모션 마스크 생성
- **이벤트 판정**
  - 좌석 ROI: `occupied / vacant` 상태 전이 로그
  - 금지구역 ROI: `intrusion_start / intrusion_end` 로그
- **로그 저장**
  - JSON Lines(`.jsonl`) 또는 텍스트(`.txt`)로 저장 (분석/ETL 친화)

---

## 3. 파이프라인 (How)
1) VideoCapture로 프레임 읽기 (웹캠 or 파일)  
2) 전처리: `BGR → Gray → GaussianBlur`  
3) 프레임 차분: `absdiff(prev, curr)`  
4) 이진화: `threshold()`  
5) 노이즈 정리: `dilate()`  
6) ROI별 모션 점수 계산 (ROI 내부 흰 픽셀 비율/면적 등)  
7) 상태머신으로 이벤트 판정 (점유/퇴실/침입 시작/종료)  
8) Logger로 이벤트 기록(JSONL)

---

## 4. 폴더 구조
(초기 구조 / 확장 고려)

